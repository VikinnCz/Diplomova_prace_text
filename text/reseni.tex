\chapter{Teorie}

Semestrální práce se zejména zabývá problematikou \acs{MIR}. Popsánou v kapitole (!doplnit kapitolu!).
Důležitou roli zde hraje i úvaha nad realizací světelných animací.
Je důležité aby bylo přemýšleno nad principem reakce světelných animací na hudbu.
Nabízejí se otázky jak by měla daná animace reagovat na konkrétní děj skladby.
Jakým způsobem navrhnout strukturu \dots

V táto části je popsána teorie zpracování hudební nahrávky pomocí známých algoritmů jako je například \acs{FFT} (\acl{FFT}) 
či nabízené možnosti strojového učení. Struktura a možnosti systému Spectoda pro generování interaktivních světelných animací.
Uměleckou částí, jak by měla animace prezentovat hudbu.

\section{MIR - Music information retrieval}
    Music information retrieval je interdisciplinární vědní obor sostředící se na získávání infromací z hudebních nahrávek.
    Jsou zde kombinovány znalosti mnoha oborů jako jsou muzikologie, psychoakustika, strojové učení, zpracování signálů a další. 
    

    Výstup jeho výzkumu je využíván populárními technologiemi. 
    Jednou z aplikací je personalizované doporučování hudebních skladeb, která se nachází v moderních streamovacích platformách.
    Další využítí je v programech pro mixování hudby používaných diskžokeji k plynulejší práci díky alanýze tempe a klíčových částí skladby.
    Tyto technologie se nachází v mnoha dalších aplikacích a s šířením se digitálního audia jejich důležitost stále poroste.
    \cite{lidy09:448[TUW-181186]}\cite{a_new_companion_to_digital_humanities}
    
    \subsection{Historie}
    \acs*{MIR} se začíná objevovat koncem devatenáctého a začátkme dvacátého století s příchodem moderních statistických metod.
    V některých univerzitách tyto statistické metody začínají aplikovat na hudebu.
    Ze začátku díky špatné dostupnosti počítačů se jedná spíše o ruční přepisování tabulatur přímo z hudebních partitur.
    Následně se ze zjištěných rysů snažili specifikovat stylové chrakteristiky.  
    S příchodem počítačů do výzkumných laboratoří v letech 1960 až 1970 se začalo více soutředit na počítačovou analýzu hudeby.
    V těchto letech se poprvé začaly objevoat nyní známé termíny jako \uv{\it computational musicology} a \uv{\it music information retrieval}
    První oblastí výzkumu bylo získávání rytmu hudbení nahrávky a z důvodu nízké popularity se výzkum zpomalil.
    Tento trend následoval až do roku 1990 kdy vázkumu \acs*{MIR} pomohly dvě věci.
    První z nich bylo velké zvětšování lehce dostupné hudby a druhým z důležitých bodů byl nárůst výpočetního výkonu počítačů.
    Díky těmto bodům se stal výzkum dostupnější a jednodužší na realizaci.

    Poté v říjnu roku 2000 bylo uspořádáno první mezinárodní symposium soustředící se na \acs*{MIR}.
    Následně díky těmto pokrokům vznika celosvětová skupina \acs{ISMIR} (\acl{ISMIR}).
    Zanedlouho naté vznikla další skupina \acs{MIREX} (\acl{MIREX}). Jedná se o skupinu vědců která se schází pravidelně každý rok a řeší problematiku \acs{MIR}.
    
   \subsection{Řetězec zpracování - pipeline}

    Téměř standardně využívaný řetězec procesů v aplikacíc \acs{MIR} je popsána níže. 

    Jako vstupní data se využívají zejména hudební informace v digitální potobě.
    Tyto data se rozlišují do více typů. Mohou to být obrázky představující digitální formu zápisu hudby pomocí symbolů (not).
    Dalším možným typem je "digitální hudba", představovaná zápisem v \acs{MIDI} notách.
    V této práci budou jako vstupní data yvužívány digitální hudební nahrávky ("digitální audio"). 

    Pokud jsou vstupní data komplexní na začátku je v řetězci zařezen blok předzpracování, která se stará o komprimaci vstupních singálů.
    U hudebních signálů se jedná například o konverzi stereo signálů na mono signál
    a jeho následnou komprimaci popsanou více v bodě 
    %TODO: odkaz na bod audio

    Dalším bodem v řetězci je extrakce vlastností signálu. 
    Zde je je nastaven poměr mezi vlastnostmi důležitými pro strojové učení lidskou expertní znalost.
    Poměr mezi těmito vlastnostmi závisí na aplikaci pro kterou je algoritmus určen.
    Ná základě získaných vlastností je nastavena struktura algoritmu pro odvození výsldných parametrů.

\begin{figure}[H]
    \centering
    \includegraphics[width = 0.4\linewidth]{obrazky/MIR-diagram.png}
    \caption{Řetězec procesů MIR \cite{a_new_companion_to_digital_humanities}}
    \label{fig:MIR_diagram}
\end{figure}

    Zpracování audio signálů je již dvě desetilétí hlavním trendem výzkumu \acs*{MIR}.
    Je to přirození tím, že zde není téměř žádná přirozená hranice a je možné téměř vše.
    Právní podmínky jsou zde příznivé a vědecké instituce nemají problém pro svou práci získat velké množství materiálu chráněného autorským právem.
    Z důvodu velké komplexsnosti vstupních signálů se využívá několik technik komprimaca signálů kterými jsou. 
    Slučování vícekanálových nahrávek do mono sginálu. Převzorkování signálu na nižší vzorkovací kmitočty,
    a rozložení signálu na krátké překrývající se úseky ze kterých mohou být nezávisle extrahovány jejich vlastnosti. 
    Výsledkem je kolekce paralelně složených sekvencí hodnot vlastností, které se následně použijí pro odvozování (inference).

  \begin{table}[H]
    \centering
    \begin{tabular}{|p{0.07\linewidth} | p{0.31\linewidth} | p{0.27\linewidth} | p{0.25\linewidth}|}
        \hline
        {\bf Data}                 & {\bf Vyhledávání informací} & {\bf Klasifikace a odhad} & {\bf Sekvenční značení}\\
        \hline
        Audio                      & Identifikace skladby,
                                     Řazení,
                                     Měření podobnosti,
                                     Získání otisku,
                                     Generování seznamu skladeb
                                   & Identifikace umělce a skladatele,
                                     Žánr a nálada,
                                     Určení tempa
                                   & Extrakce melodie,
                                     Odhad akordů,
                                     Detekce nástupů,
                                     Segmentace                   \\
        \hline
    \end{tabular}
    \caption{Typické procesy na základně vstupních a výstupních dat.}
    \label{tab:MIR_typicke_procesy}
  \end{table}

  %TODO: současné problémy


  \section{Parametrizace hudebních nahrávek}
  V této kapitole je popsán audio signál. Jak vzniká, jeho reprezentace v číslicovám zpracování a základní principy práce s audiosignálem.
  V bodech \ref{sec:Frekvence} až \ref{sec:Barva} jsou popsány parametry získávané z audio signálu. %TODO: doplnit správné reference
  Získané parametry slouží pro přesnější popis skladby. \cite{fundamental_of_music_processing}

  \subsection{Reprezentace audio signálů}
  Hudba může být reprezentována spoustou forem. 
  Jako tradiční médium pro její ukládání ještě před vznikem záznamu sloužily vždy noty a další typy zápisů pomocí symbolů.
  Výsledné hudební dílo ale představuje mnohem více než počáteční notový zápis.
  Každý hudebník a hudební nástroj do skladby dodává svou unikátnost.
  Při hře se noty začnou proměňovat v harmonické zvuky, hladké melodie a nástroje vzájemně rezonují. 
  Každý z hudebníků do skladby přináší svou interptretaci. Jinak reagují na tempo zvýrazňují odlišné noty a liší se jejich artikulace.
  Všechny tyto proměnné ve výsledku způsobují, že dílo není jen mechanické přehrání napsaná partitury.
  Jeho součástí se stává unikátní přednes.

  Při pohledu z fyzikálního hlediska důsledkem interpretace díla vznikají zvukové vlny šířící se vzduchem.
  Tyto vlny jsou reprezentovány kmítáním atomů plynu způsobující změny tlaku svým zhušťováním a zřěďováním. Při vlnění nedochází k přenosu hmotných částit.
  Záznamem šířících se zvukových vln získáváme audio signál.
  Pojmem audio je označován řetězec sloužící k záznamu, přenosu a reprodukci zvuků v mezích lidského slyšení. 
  Avšak v audio signálu se už nenachází přesná reprezentace not a jejich paramterů jako jsou čas nástupu, tón, délka trvání, dynamika.
  Díky tomu je analýza hudebních signálů obtížným úkolem a je ovlivněna reprezentací interpreta akustikou prostoru a vnímáním posluchače.
  Popsanými problémy se zabývá samostatný vědní obor s názvem psychoakustika.
  Nejdůležitějšími parametry audio signálu které jsou podrobně popsány níže definujeme: frekvence, výška tónu, dynamika, intenzita, hlasitost a také barva.


  \subsection{Časová oblast}
  Základní reprezentací audio signálu je tzv zobrazení v \textbf{časové oblasti}.
  V časové oblasti číslicový signál představují vzorky. Jednotlivé vzorky udávají hodnotu signálu v daném čase.
  Počet vzorků nám určuje vzorkovací frekvence signálu. Důležé pravidlo pro vzorkování signálu je popsáno rovnicí č. \ref*{rov:vzorkovaci_teorem}
  
  \begin{equation}
    f_{vz} > 2 * f_{max}
    \label{rov:vzorkovaci_teorem}
  \end{equation}

  kde $f_{vz}$ je vzorkovací frekvence a $f_{max}$ je maximální frekvence v audio signálu.  
  Pokud jednotlivé vzorky zobrazíme graficky získáme průběh amplitudy signálu viz obrázek č.\ref*{fig:Waveform}

  \begin{figure}[H]
    \centering
    \includegraphics[width = 0.8\linewidth]{obrazky/Waveform.png}
    \caption{Zobrazení časového průběhu signálu}
    \label{fig:Waveform}
  \end{figure}

  Tato reprezentace audio signálu poskytuje informace o amplitudě signálu. Čili je z ní možno vyčíst například dynamiku skladby, začátky a konce not.
  
  \subsection{Frekvenční oblast}
  Pro získání více informací o hudebním díle je zobrazení v časové oblasti nedostatečné.
  Proto se využívá tzv zobrazení ve \textbf{frekvenční oblasti}.

  V časové oblasti se zobrazuje frekvenční spektrum signálu.
  Toto spektrum představuje rozložení původní části signálu na jednotlivé harmonické frekvence reprezentující zpracovávaný signál.
  V grafu jsou poté zobrazy frekvenční složky se kterých se signál zkládá viz obrázek č.\ref*{fig:Bass_tone} %TODO: přidat obrázek spektrogrmu

  \begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.8\linewidth}
        \includegraphics[width = \linewidth]{obrazky/Bass_tone_waveform.png}
        \caption{Časová oblast}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\linewidth}
        \includegraphics[width = \linewidth]{obrazky/Bass_tone_spectrum.png}
        \caption{Frekvenční oblast}
    \end{subfigure}
    \caption{Reprezentace tónu E zahraného na basovou kytaru.}
    \label{fig:Bass_tone}
\end{figure}
  
  Jako nzorný důvod proč je transformace do frekvenční oblasti přínosná je dán příklad. Na nástroj je zahrán tón, který je nahrán. 
  V časové oblasti je možné určit délku tónu a jeho průběh podle ADSR obálky popsané v bodě č. \ref*{sec:Barva}.
  Pokud je ale potřeba zjistit výšku tónu a určit notu, tak je to téměř nemožné.
  Díky transformaci do frekveční oblasti je patrná fundementální harmonická frekvence tónu.
  Tato frekvence udává výšku tónu a je tak možné stanovit notu která byla zahrána.

  Pro získání frekvenčního spektra signálu je třeba transformovat signál s časové oblasti.
  K tomu se využívá \textbf{Fourierovy transformace}. 

  Hlavní faktem Fourierovy transformace je, že každý periodický signál je možné rozložit na součet někonečně mnoha sinusových signálů s různou amplitudou a fází.
  Toho je poté pomoí matematickýh postupů docílit.
  Analyzující signál je rozložen na jeho frekvenční složky udávané amplitudou a fází.
  Při grafickém zobrazení získaných složek vzniká spektrogram analyzovaného signálu viz obrázek č.\ref*{fig:Bass_tone} zobrazující jeho frekvenční koeficienty.
  
  efektivního algoritmu z ní odvozeného tvz \acs{FFT} (\acl{FFT}).


  \textbf{\acs{DFT}} (\acl{DFT}).
  %TODO: Popsat více o  FFT a DFT


  %TODO: popsat parametry z knížky: frekvence, výška, dynamika, barva atd...

  \subsection{Frekvence} \label{sec:Frekvence}

  \subsection{Barva} \label{sec:Barva}

  Jedním z důležiitých nástrojů pro jeho nalaýzuj je určení obálky signálu.
  %TODO: Popsat ADSR obálku

\section{Detekce tempa a dob}
\section{Klasifikace žánrů a nálady}

\section{Systém Spectoda}

\section{Hudební signál jako animace}